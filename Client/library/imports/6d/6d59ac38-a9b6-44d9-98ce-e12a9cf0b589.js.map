{"version":3,"sources":["assets\\Scripts\\Modules\\Controllers\\ControllerApp.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Controller from \"../../MVCFramework/Controller\";\r\nimport MessageNames from \"../MessageNames\";\r\nimport ViewApp from \"../Views/ViewApp\";\r\nimport { ViewNames, ModelNames } from \"../MVCRegister\";\r\nimport ModelApp from \"../Models/ModelApp\";\r\nimport Toast from \"../../Tools/Toast\";\r\nimport { ImageTool } from \"../../JsTool/ImageTool\";\r\nimport OpenNetworkingUI from \"../../Tools/OpenNetworkingUI\";\r\nimport Language from \"../../Global/Language\";\r\nimport { ProxyInfoRsp, SubmitDepositRsp, SubmitOrderRsp } from \"../../Protos/BankProxy\";\r\n\r\nexport default class ControllerChat extends Controller {\r\n    viewAppStart: ViewApp;\r\n    testImage = new Image();\r\n\r\n    modelApp: ModelApp;\r\n\r\n\r\n    public Init() {\r\n        this.modelApp = this.GetModel(ModelNames.ModelApp) as ModelApp;\r\n        this.modelApp.SetSelfPlayerID(window[\"selfId\"]);\r\n        this.modelApp.SetbankProxyId(window[\"proxyId\"]);\r\n    }\r\n    public Clean() {\r\n\r\n    }\r\n\r\n    public OnReceiveMessage(msg: string, msgBody: any) {\r\n        console.log(\"msg\", msg)\r\n        if (msg == MessageNames.StartLogin) {\r\n            //   this.modelApp.StartLogin();\r\n            this.ShowAppStartView()\r\n        }\r\n        else if (msg == MessageNames.ShowAppStartView) {\r\n            this.ShowAppStartView();\r\n        } else if (msg == MessageNames.ShowProxyInfo) {\r\n            this.UpDateProxyInfo(msgBody);\r\n        } else if (msg == MessageNames.SubmitDeposit) {\r\n\r\n            this.ShowSubmitDeposit(msgBody);\r\n        } else if (msg == MessageNames.SubmitOrder) {\r\n            this.DoneSubmitOrder(msgBody);\r\n        }\r\n\r\n    }\r\n    public UpDateProxyInfo(data: ProxyInfoRsp) {\r\n        if (!data.bankTypes || data.bankTypes.length < 1) {\r\n            return;\r\n        }\r\n        this.viewAppStart.ShowComByType(1);\r\n        //for (let i = 0; i < data.bankTypes.length; i++) {\r\n        this.viewAppStart.UpdataPage(data)\r\n        //}\r\n    }\r\n    public ShowSubmitDeposit(data: SubmitDepositRsp) {\r\n        this.viewAppStart.ShowComByType(2);\r\n        this.viewAppStart.ShowSubmitInfo(data)\r\n    }\r\n    public DoneSubmitOrder(data: SubmitOrderRsp) {\r\n        this.viewAppStart.SetEnableButton(false);\r\n    }\r\n\r\n    public ShowAppStartView() {\r\n        if (this.viewAppStart == null) {\r\n            this.viewAppStart = this.GetView(ViewNames.ViewApp) as ViewApp;\r\n            this.viewAppStart.SetOnClick(\"BtnBack\", () => {\r\n                cc.log(\"退出\")\r\n            });\r\n            this.viewAppStart.SetOnClick(\"BtnSubmit\", () => {\r\n                if (this.viewAppStart.GetEditBoxStr() == null) {\r\n                    Toast.Show(Language.Chargetip1);\r\n                    return;\r\n                }\r\n                if (Number(this.viewAppStart.GetEditBoxStr()) <= 0) {\r\n                    Toast.Show(Language.Chargetip2);\r\n                    return;\r\n                }\r\n                cc.log(\"确认充值\", this.modelApp.GetBankType())\r\n                if (!this.modelApp.GetBankType()) {\r\n                    Toast.Show(Language.Chargetip3);\r\n                   // return;\r\n                }\r\n                this.viewAppStart.ShowComByType(2)\r\n                let bankType = this.modelApp.GetBankType();\r\n                let amount = Number(this.viewAppStart.GetEditBoxStr());\r\n                this.modelApp.ReqSubmitDeposit(bankType, amount);\r\n                //充值数据\r\n               \r\n\r\n            })\r\n            //界面2逻辑按钮\r\n            this.viewAppStart.SetOnClick(\"BtnUpload\", () => {\r\n                cc.log(\"上传\")\r\n                ImageTool.Get((imageData: string) => {\r\n                    this.testImage.onload = () => {\r\n\r\n                        if (imageData.length == 0) {\r\n                            Toast.Show(Language.Chargetip1);\r\n                            return;\r\n                        }\r\n                        this.viewAppStart.ShowImageUpload(imageData);\r\n                        this.viewAppStart.SetEnableButton(true);\r\n                    };\r\n                    this.testImage.src = imageData;\r\n                });\r\n\r\n            })\r\n            this.viewAppStart.SetOnClick(\"BtnSubmit_info\", () => {\r\n                cc.log(\"确认订单\")\r\n                if (this.viewAppStart.GetEnableButton()) {\r\n                    let order = this.modelApp.GetOrderNoe();\r\n                    let desc = this.viewAppStart.GetEditBoxStrBeiZhu();\r\n                    let imageData = this.testImage.src;\r\n                    this.modelApp.ReqSubmitOrder(order, imageData, desc);\r\n                }\r\n            })\r\n            this.viewAppStart.SetOnClick(\"BtnBack_info\", () => {\r\n                cc.log(\"离开info界面\")\r\n                this.viewAppStart.ShowComByType(1);\r\n            })\r\n            this.viewAppStart.addBtnCopyClick();\r\n        }\r\n\r\n        this.viewAppStart.SetSelfPlayerID(window[\"selfId\"]);\r\n        this.viewAppStart.Show(() => {\r\n            // 请求协议\r\n            // OpenNetworkingUI.Hide();\r\n\r\n            this.viewAppStart.ShowComByType(1)\r\n            this.modelApp.ReqProxyInfo();\r\n        });\r\n\r\n\r\n\r\n    }\r\n}\r\n"]}