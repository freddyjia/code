{"version":3,"sources":["assets\\Scripts\\MVCFramework\\ViewManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import View from \"./View\";\nimport { MVCRegister, ViewNames } from \"../Modules/MVCRegister\";\nimport ViewConfigs, { LayerOrderNum, LoadingStyle } from \"../Modules/ViewConfigs\";\nimport Util from \"../Tools/Util\";\nimport TimerManager from \"../Components/TimerManager\";\nimport XTween from \"../Tools/XTween/XTween\";\nimport ccC from \"../Tools/ccC\";\nimport { XTweenCurvType } from \"../Tools/XTween/Base/XTweenCurv\";\n\n// //UI节点上的gameobject名称\n// enum LayerOrderName {\n//     UINormal = \"UINormal\",\n//     UIPopup = \"UIPopup\",\n//     UITop = \"UITop\"\n// };\n\nexport default class ViewManager\n{\n    private static viewNormalPopupStackArray:Array<View> = [];\n    // private static viewTopStackArray:Array<View> = [];\n    private static UnDestroyViews:Array<string> = [ViewNames.ViewToast,ViewNames.ViewDialogNormal,ViewNames.ViewOpenNetworking];\n    private static UINormal:cc.Node;\n    private static UIPopup:cc.Node;\n    private static UITop:cc.Node;\n    private static UITopper:cc.Node;\n    private static dicViews:{[viewName:string]:View} = {};\n    private static viewWithNodes:Array<View> = [];\n\n    private static bigLoading:cc.Node;\n    private static spriteProgress:cc.Sprite;\n    private static labelProgress:cc.Label;\n\n    private static smallLoading:cc.Node;\n    private static Loading_LOGO:cc.Sprite;\n\n    private static loadingErr:cc.Node;\n    private static LoadingEff:cc.Node;\n    private static LoadingMask:cc.Node;\n\n    public static Clean()\n    {\n        this.DestroyAllView();\n        this.ClearAllViewStack();\n        this.viewNormalPopupStackArray = [];\n        // this.viewTopStackArray = [];\n    }\n\n    public static Init()\n    {\n        if(this.UINormal != null)\n        {\n            return;\n        } \n        let mainNode = cc.find(\"Main\");\n        cc.game.addPersistRootNode(mainNode);\n        let canvasNode = cc.find(\"Canvas\");\n        cc.game.addPersistRootNode(canvasNode);\n\n        this.UINormal = cc.find(\"Canvas/UINormal\");\n        this.UIPopup = cc.find(\"Canvas/UIPopup\");\n        this.UITop = cc.find(\"Canvas/UITop\");\n        this.UITopper = cc.find(\"Canvas/UITopper\");\n\n        this.bigLoading = cc.find(\"Canvas/UILoading/BigLoading\");\n        this.LoadingMask = cc.find(\"Canvas/UILoading/LoadingMask\");\n        this.Loading_LOGO = cc.find(\"Loading_LOGO\",this.bigLoading).getComponent(cc.Sprite);\n        this.spriteProgress = cc.find(\"Progress/SpriteProgress\",this.bigLoading).getComponent(cc.Sprite);\n        this.labelProgress = cc.find(\"Progress/LabelProgress\",this.bigLoading).getComponent(cc.Label);\n        this.LoadingEff = cc.find(\"LoadingEff\",this.spriteProgress.node);\n\n        this.smallLoading = cc.find(\"Canvas/UILoading/SmallLoading\");\n\n        this.loadingErr = cc.find(\"Canvas/UILoading/LoadingErr\");\n\n        this.Loading_LOGO.node.active = false;\n        \n    }\n\n    private static SetTransformDic(node:cc.Node,dicTransforms:{[transformName:string]:cc.Node})\n    {\n        dicTransforms[node.name] = node;\n        for(let i = 0;i<node.childrenCount;i++)\n        {\n            this.SetTransformDic(node.children[i],dicTransforms);\n        }\n    }\n\n    private static SetHideView(view:View)\n    {\n        if(view.isShow == false)\n        {\n            return;\n        }\n        if(view.node != null)\n        {\n            view.node.active = false;\n        }\n        view.isShow = false;\n        if(view.onHideViewCallback != null)\n        {\n            view.onHideViewCallback();\n        }\n        view.OnHideView();\n    }\n\n    private static AllLoadFinish(view:View,getPrefabCallback,timerID)\n    {\n        TimerManager.GetInstance().DeleteTimer(timerID);\n\n        TimerManager.GetInstance().CallActionDelay(()=>{\n            if(view.viewConfig.loadingStyle != LoadingStyle.None)\n            {\n                this.bigLoading.active = false;\n                this.smallLoading.active = false;\n            }\n        },0.1,null,0,0,true);\n        this.LoadingMask.active = false;\n\n        if(view.viewConfig.loadingStyle == LoadingStyle.FullScreen)\n        {\n            // this.spriteProgress.fillStart = 1;\n            // this.labelProgress.string = \"100%\";\n            this.SetProgress(1);\n        }\n        \n        if(view.layer == LayerOrderNum.UINormal)\n        {\n            view.node.setParent(this.UINormal);\n        }\n        else if(view.layer == LayerOrderNum.UIPopup)\n        {\n            view.node.setParent(this.UIPopup);\n            //TODO: add mask\n            ccC.loadRes(\"Prefab/ButtonMask\",cc.Prefab,\n            (errloadMask: Error, perfabMask: any)=>{\n                if (errloadMask) {\n                    cc.error(\"err  \" + errloadMask.message || errloadMask);\n                    return;\n                }\n                let nodeMask:cc.Node = cc.instantiate(perfabMask);\n                nodeMask.setParent(view.node);\n                nodeMask.setSiblingIndex(0);\n                nodeMask.setPosition(0,0);\n                nodeMask.name = \"PopUIMask\";\n                nodeMask.getComponent(cc.Widget).updateAlignment();\n\n                Util.SetClickAction(nodeMask.getComponent(cc.Button),()=>{\n                    if(view.removeMaskClick == false)\n                        view.Hide();\n                });\n            });\n        }\n        else if(view.layer == LayerOrderNum.UITop)\n        {\n            view.node.setParent(this.UITop);\n        }\n        else if(view.layer == LayerOrderNum.UITopper)\n        {\n            view.node.setParent(this.UITopper);\n        }\n        view.node.setPosition(0,0);\n        \n        view.OnAwake();\n        view.SetButtonClicks();\n        getPrefabCallback(true,\"\");\n        view.isLoadingAsync = false;\n    }\n\n    private static SetProgress(progress)\n    {\n        this.spriteProgress.fillStart = progress;\n        this.labelProgress.string = (Math.floor(progress * 100)).toString() + \"%\";\n        this.LoadingEff.position = new cc.Vec2(-378 + 756 * progress,0);\n    }\n\n    private static CreateViewObj(view:View,getPrefabCallback:(success:boolean,errMsg:string)=>void)\n    {\n        view.isLoadingAsync = true;\n\n        let timerID;\n        if(view.viewConfig.loadingStyle != LoadingStyle.None)\n        {\n            this.LoadingMask.active = true;\n            //加载1秒还没完成就需要显示加载条\n            timerID = TimerManager.GetInstance().CallActionDelay(()=>{\n                if(view.isLoadingAsync == true)\n                {\n                    if(view.viewConfig.loadingStyle == LoadingStyle.FullScreen)\n                    {\n                        this.bigLoading.active = true;\n                        // this.spriteProgress.fillStart = 0;\n                        // this.labelProgress.string = \"0%\";\n\n                        /*\n                        var imagePath = \"MainGame/textures/Login/DL_LOGO\";\n                        ccC.loadRes(imagePath, cc.SpriteFrame, (err: Error, texture: any) =>{\n                            if (err) {\n                                cc.error(\"err  \" + err.message || err);\n                                return;\n                            }\n                            this.Loading_LOGO.spriteFrame = texture;\n                        });\n                        */\n\n                        this.SetProgress(0);\n                    }\n                    else\n                    {\n                        this.smallLoading.active = true;\n                    }\n                }\n            },1,null,0,0,true);\n        }\n        \n        //view prefab占总加载比的最大比例\n        let mainMaxProgress;\n        mainMaxProgress = 0.9 / (view.dependentRes.length + 1);\n        \n        if(mainMaxProgress < 0.4)\n        {\n            mainMaxProgress = 0.4;\n        }\n\n        let mainProgress = 0;\n        let dependentProgressDic:{[path:string]:number} = {};\n        let finishStateDic:{[path:string]:boolean} = {};\n        let currentProgress = 0;\n        let progressAddTimer = null;\n\n        //每个依赖占的比例\n        let perMaxProgress = (0.9 - mainMaxProgress) / view.dependentRes.length;\n\n        let funcCheckFinish = ()=>{\n            let allfinish = true;\n            for(let path in finishStateDic)\n            {\n                if(finishStateDic[path] == false)\n                {\n                    allfinish = false;\n                    break;\n                }\n            }\n            if(allfinish)\n            {\n                TimerManager.GetInstance().DeleteTimer(progressAddTimer);\n                this.AllLoadFinish(view,getPrefabCallback,timerID);\n            }\n        }\n\n        let funcUpdateProgress = ()=>{\n            if(view.viewConfig.loadingStyle == LoadingStyle.FullScreen)\n            {\n                let allDependentProgress = 0;\n                for(let dependentPath in dependentProgressDic)\n                {\n                    allDependentProgress += dependentProgressDic[dependentPath];\n                }\n\n                let progress = allDependentProgress + mainProgress;\n                if(progress > currentProgress)\n                {\n                    currentProgress = progress;\n                }\n                // this.spriteProgress.fillStart = currentProgress;\n                // this.labelProgress.string = (Math.floor(currentProgress * 100)).toString() + \"%\";\n                this.SetProgress(currentProgress);\n\n                if(currentProgress > 0.98)\n                {\n                    TimerManager.GetInstance().DeleteTimer(progressAddTimer);\n                }\n            }\n        }\n\n        let cnt = 0;\n        if(view.viewConfig.loadingStyle == LoadingStyle.FullScreen)\n        {\n            progressAddTimer = TimerManager.GetInstance().CallActionDelay(()=>{\n                cnt ++;\n                let step = 0.1 / (cnt * cnt);\n                if(step > 0.01)\n                {\n                    step = 0.01;\n                }\n                else if(step < 0.002)\n                {\n                    step = 0.002;\n                }\n                currentProgress += step;\n                if(currentProgress > 0.95)\n                {\n                    currentProgress = 0.95;\n                }\n                funcUpdateProgress();\n            },0.5,null,120,0,true);\n        }\n        \n        for(let i=0;i<view.dependentRes.length;i++)\n        {\n            let dependentPath = view.dependentRes[i];\n            dependentProgressDic[dependentPath] = 0;\n            finishStateDic[dependentPath] = false;\n            ccC.loadResProgressWithoutType(dependentPath,\n                (completedCount: number, totalCount: number, item: any) =>{\n                    dependentProgressDic[dependentPath] = perMaxProgress * completedCount / totalCount;\n                    if(view.isLoadingAsync == true)\n                        funcUpdateProgress();\n                }, (err: Error, perfab: any) => {\n                    dependentProgressDic[dependentPath] = perMaxProgress;\n                    finishStateDic[dependentPath] = true;\n                    if(view.isLoadingAsync == true)\n                        funcCheckFinish();\n                });\n        }\n        \n        finishStateDic[view.viewConfig.prefabPath] = false;\n\n        ccC.loadResProgress(view.viewConfig.prefabPath,cc.Prefab,\n            (completedCount: number, totalCount: number, item: any) =>{\n                mainProgress = completedCount / totalCount * mainMaxProgress;\n                if(view.isLoadingAsync == true)\n                    funcUpdateProgress();\n            },\n            (err: Error, perfab: any) => {\n\n                if (err != null) \n                {\n                    let errMsg = \"加载 view prefab 错误:\" + err.message;\n                    getPrefabCallback(false,errMsg);\n                    cc.error(errMsg);\n\n                    if(view.viewConfig.loadingStyle != LoadingStyle.None)\n                    {\n                        this.bigLoading.active = false;\n                        this.smallLoading.active = false;\n                        this.LoadingMask.active = false;\n                    }\n                    view.isLoadingAsync = false;\n\n                    this.loadingErr.active = true;\n                    this.loadingErr.opacity = 255;\n\n                    let tweener = XTween.DoValue(this.loadingErr,(value)=>{\n                        this.loadingErr.opacity = value * 255;\n                    },1,0,1,1,false,XTweenCurvType.Liner,null,2);\n                    tweener.SetFinishCallback(()=>{\n                        this.loadingErr.active = false;\n                    });\n                    tweener.Play();\n                    \n                    return;\n                }\n\n                let node:cc.Node = cc.instantiate(perfab);\n                \n                node.name = view.name;\n                view.node = node;\n                this.SetTransformDic(node,view.transformCache);\n                this.viewWithNodes.push(view);    \n                \n                finishStateDic[view.viewConfig.prefabPath] = true;\n                mainProgress = mainMaxProgress;\n                funcCheckFinish();\n        });\n    }\n\n    private static SetShowView(view:View,showviewCallback:(success:boolean,errMsg:string)=>void)\n    {\n\n        let funcCallback = (success:boolean,errMsg:string)=>{\n\n            if(success == true)\n            {\n                view.node.active = true;\n                view.isShow = true;\n                view.node.setSiblingIndex(view.node.parent.childrenCount - 1);\n\n                showviewCallback(true,\"\");\n\n                if(view.onShowViewCallback != null)\n                {\n                    view.onShowViewCallback();\n                }\n                \n                view.OnShowView();\n            }\n            else\n            {\n                showviewCallback(false,errMsg);\n            }\n        \n        };\n        if(view.node == null)\n        {\n            this.CreateViewObj(view,funcCallback);\n        }\n        else\n        {\n            funcCallback(true,\"\");\n        }\n        \n    }\n\n    public static GetView(viewName):View\n    {\n\n        let view = this.dicViews[viewName];\n        if(view == null)\n        {\n            view = MVCRegister.dicViews[viewName]();\n            if(view == null)\n            {\n                cc.error(\"viewName \" + viewName + \" 未注册\");\n                return null;\n            }\n            this.dicViews[viewName] = view;\n        }\n        // let view = MVCRegister.dicViews[viewName]();\n        // if(view == null)\n        // {\n        //     cc.error(\"viewName \" + viewName + \" 未注册\");\n        //     return null;\n        // }\n        view.name = viewName;\n\n        view.showCallback = (callback:(success:boolean,errMsg:string)=>void)=>{\n\n            if(view.isShow == true)\n            {\n                callback(true,\"\");\n                return;\n            }\n\n            // cc.error(\"viewName    \" + viewName);\n            let viewConfig = ViewConfigs.GetViewConfig(viewName);\n            if(viewConfig == null)\n            {\n                let errMsg = \"viewConfig 配置为空 viewName:\" + viewName;\n                callback(false,errMsg);\n                cc.error(errMsg);\n                return;\n            }\n\n            let lastView:View = null;\n            if(this.viewNormalPopupStackArray.length != 0)\n            {\n                lastView = this.viewNormalPopupStackArray[this.viewNormalPopupStackArray.length - 1];\n            }\n\n            view.viewConfig = viewConfig;\n            view.layer = viewConfig.layer;\n\n            this.SetShowView(view,(success:boolean,errMsg:string)=>{\n                if(success == false)\n                {\n                    callback(false,errMsg);\n                    return;\n                }\n                \n                if(lastView != null && (view.layer == LayerOrderNum.UINormal ||view.layer == LayerOrderNum.UIPopup))\n                {\n                    this.DeActiveViewFuncs(lastView);\n                }\n                if(view.layer == LayerOrderNum.UINormal)\n                {\n                    for(let i = this.viewNormalPopupStackArray.length - 1;i>=0;i--)\n                    {\n                        let viewInStack = this.viewNormalPopupStackArray[i];\n                        if(viewInStack.isShow == true)\n                        {\n                            this.SetHideView(viewInStack);\n                        }\n                    }\n                }\n                else if(view.layer == LayerOrderNum.UIPopup)\n                {\n                    for(let i = this.viewNormalPopupStackArray.length - 1;i>=0;i--)\n                    {\n                        let viewInStack = this.viewNormalPopupStackArray[i];\n                        if(viewInStack.isShow == true && viewInStack.layer == LayerOrderNum.UIPopup)\n                        {\n                            this.SetHideView(viewInStack);\n                        }\n                    }\n                }\n    \n                if(view.layer == LayerOrderNum.UINormal || view.layer == LayerOrderNum.UIPopup)\n                {\n                    this.viewNormalPopupStackArray.push(view);\n                }\n                else\n                {\n                    // this.viewTopStackArray.push(view);\n                }\n    \n                if(view.layer == LayerOrderNum.UINormal || view.layer == LayerOrderNum.UIPopup)\n                {\n                    this.ActiveViewFuncs(view);\n                }\n\n                callback(true,\"\");\n\n                if(view.layer == LayerOrderNum.UIPopup)\n                {\n                    this.DoAnimation(view);\n                }\n            });\n        };\n\n        view.hideCallback = ()=>{\n            if(view.layer == LayerOrderNum.UINormal || view.layer == LayerOrderNum.UIPopup)\n            {\n                this.DeActiveViewFuncs(view);\n            }\n            if(this.viewNormalPopupStackArray.length == 1 \n                && view.layer != LayerOrderNum.UITop \n                && view.layer != LayerOrderNum.UITopper)\n            {\n                return;\n            }\n            if(view.layer == LayerOrderNum.UINormal)\n            {\n\n                //如果view不在栈顶，就要先隐藏栈上的其他pop层view\n                let deactivePop = false;\n                if(this.viewNormalPopupStackArray[this.viewNormalPopupStackArray.length - 1] != view)\n                {\n                    for(let i=this.viewNormalPopupStackArray.length - 1;i>=0;i--)\n                    {\n                        if(this.viewNormalPopupStackArray[i] == view)\n                        {\n                            break;\n                        }\n                        let popView = this.viewNormalPopupStackArray[i];\n                        if(deactivePop == false)\n                        {\n                            deactivePop = true;\n                            this.DeActiveViewFuncs(popView);\n                        }\n                        this.SetHideView(popView);\n                        Util.RemoveArray(this.viewNormalPopupStackArray,i);\n                    }\n                }\n\n\n                this.SetHideView(view);\n                this.viewNormalPopupStackArray.pop();\n                for(let i = this.viewNormalPopupStackArray.length - 1;i>=0;i--)\n                {\n                    let viewInStack = this.viewNormalPopupStackArray[i];\n                    this.SetShowView(viewInStack,(success,errmsg)=>{\n                        if(success == false)\n                        {\n                            cc.error(\"显示失败1 errmsg \" + errmsg);\n                        }\n                    });\n                    if(viewInStack.layer == LayerOrderNum.UINormal)\n                        break;\n                }\n            }\n            else if(view.layer == LayerOrderNum.UIPopup)\n            {\n                this.SetHideView(view);\n                this.viewNormalPopupStackArray.pop();\n                let lastView = this.viewNormalPopupStackArray[this.viewNormalPopupStackArray.length - 1];\n                //pop层的view消失  只会引起pop层的view的显示\n                if(lastView.layer == LayerOrderNum.UIPopup)\n                {\n                    this.SetShowView(lastView,(success,errmsg)=>{\n                        if(success == false)\n                        {\n                            cc.error(\"显示失败2 errmsg \" + errmsg);\n                        }\n                    });\n                }\n            }\n            else\n            {\n                this.SetHideView(view);\n                // this.viewTopStackArray.pop();\n            }\n\n            if(view.layer == LayerOrderNum.UINormal || view.layer == LayerOrderNum.UIPopup)\n            {\n                let lastView = this.viewNormalPopupStackArray[this.viewNormalPopupStackArray.length - 1];\n                this.ActiveViewFuncs(lastView);\n            }\n        };\n        \n        return view;\n    }\n\n    private static DoAnimation(view:View)\n    {\n        let window = cc.find(\"Window\",view.node);\n        if(window == null)\n        {\n            window = cc.find(\"window\",view.node);\n        }\n        if(window == null)\n            return;\n\n        window.scaleX = 0.8;\n        window.scaleY = 0.8;\n        \n        let action = cc.sequence(cc.scaleTo(0.08,1.1,1.1),cc.scaleTo(0.08,1,1));\n        window.runAction(action);            \n    }\n\n    public static ActiveViewFuncs(view:View)\n    {\n        if(view.isFocus == true)\n        {\n            return;\n        }\n        view.isFocus = true;\n        view.OnFocus();\n    }\n\n    public static DeActiveViewFuncs(view:View)\n    {\n        if(view.isFocus == false)\n        {\n            return;\n        }\n        view.isFocus = false;\n        view.OnDisFocus();\n    }\n\n    public static SetViewDestroy(view:View)\n    {\n        // cc.error(\"SetViewDestroy \" + view.name);\n        if(view.node == null)\n            return;\n        this.SetHideView(view);\n        view.OnDestroy();\n        view.node.destroy();\n        view.node = null;\n    }\n\n    public static DestroyAllView()\n    {\n        for(let i = 0;i<this.viewWithNodes.length;i++)\n        {\n            let view = this.viewWithNodes[i];\n            // if(view.layer == LayerOrderNum.UITop)\n            //     continue;\n            let findUnDestroy = false;\n            for(let j = 0;j<this.UnDestroyViews.length;j++)\n            {\n                if(view.name == this.UnDestroyViews[j])\n                {\n                    findUnDestroy = true;\n                    break;\n                }\n            }\n            if(findUnDestroy == true)\n            {\n                continue;\n            }\n            else\n            {\n                this.SetViewDestroy(view);\n            }\n        }\n    }\n\n    public static ClearAllViewStack()\n    {\n        this.viewNormalPopupStackArray = [];\n\n        for(let viewName in this.dicViews)\n        {\n            let findUnDestroy = false;\n            for(let j = 0;j<this.UnDestroyViews.length;j++)\n            {\n                if(viewName == this.UnDestroyViews[j])\n                {\n                    findUnDestroy = true;\n                    break;\n                }\n            }\n\n            //如果不在非删列表里就删掉\n            if(findUnDestroy == false)\n            {\n                delete(this.dicViews[viewName]);\n                this.dicViews[viewName] = null;\n            }\n        }\n    }\n    \n}\n"]}