{"version":3,"sources":["assets\\Scripts\\Manager\\AudioManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import LocalStorageKey from \"../Global/LocalStorageKey\";\nimport ccC from \"../Tools/ccC\";\n// import Global from \"../Global/Global\";\n\nexport default class AudioManager\n{\n    private bgmVolume:number = 1;\n    private audioVolume:number = 1;\n    private playingBGM:string;\n\n    private static m_Instance:AudioManager = null;\n    public static GetInstance():AudioManager\n    {\n        if(this.m_Instance == null)\n        {\n            this.m_Instance = new AudioManager();\n        }\n        return this.m_Instance;\n    }\n\n    public Init()\n    {\n        if(localStorage.getItem(LocalStorageKey.BgmVolume) == null)\n        {\n            localStorage.setItem(LocalStorageKey.BgmVolume,\"1\");\n        }\n        if(localStorage.getItem(LocalStorageKey.AudioVolume) == null)\n        {\n            localStorage.setItem(LocalStorageKey.AudioVolume,\"1\");\n        }\n        this.bgmVolume = parseFloat(localStorage.getItem(LocalStorageKey.BgmVolume));\n        this.audioVolume = parseFloat(localStorage.getItem(LocalStorageKey.AudioVolume));\n\n        cc.audioEngine.setMaxAudioInstance(10);\n        cc.audioEngine.setMusicVolume(this.bgmVolume);\n        cc.audioEngine.setEffectsVolume(this.audioVolume);\n    }\n\n    public GetBgmVolume():number\n    {\n        return this.bgmVolume;\n    }\n\n    public GetAudioVolume():number\n    {\n        return this.audioVolume;\n    }\n\n    public SetBgmVolume(value:number)\n    {\n        this.bgmVolume = value;\n        cc.audioEngine.setMusicVolume(this.bgmVolume);\n        localStorage.setItem(LocalStorageKey.BgmVolume,value.toString());\n    }\n\n    public SetAudioVolume(value:number)\n    {\n        this.audioVolume = value;\n        cc.audioEngine.setEffectsVolume(this.audioVolume);\n        localStorage.setItem(LocalStorageKey.AudioVolume,value.toString());\n    }\n\n    public SoundPlay(path:string,isLoop:boolean=false,callback:(audioID:number)=>void=null)\n    {\n        //cc.error(path+\"#############\");\n        ccC.loadRes(path, cc.AudioClip, function (err, clip:cc.AudioClip) {\n            if (err) {\n                cc.error(\"err  \" + err.message || err);\n                return;\n            }\n            try{\n                // cc.error(clip);\n                // cc.error(\"clip is here-------------------\");\n                var audioID = cc.audioEngine.playEffect(clip, isLoop);\n                if(callback != null)\n                {\n                    callback(audioID);\n                }\n            }\n            catch(err)\n            {\n                cc.error(err);\n                cc.error(path+\"音效有一点点错误--------------------\");\n            }\n           \n        });\n    }\n\n    public SoundPlayWithVolume(path:string,isLoop:boolean=false,volume:number=1,callback:(audioID:number)=>void=null){\n        ccC.loadRes(path, cc.AudioClip, function (err, clip:cc.AudioClip) {\n            if (err) {\n                cc.error(\"err  \" + err.message || err);\n                return;\n            }\n            var audioID = cc.audioEngine.playEffect(clip, isLoop);\n            cc.audioEngine.setVolume(audioID,volume)\n            if(callback != null)\n            {\n                callback(audioID);\n            }\n        });\n    }\n\n    public SoundPause(audioID)\n    {\n        cc.audioEngine.pauseEffect(audioID);\n    }\n\n    public SoundAllPause()\n    {\n        cc.audioEngine.pauseAll();\n    }\n\n    public SoundStop(audioID)\n    {\n        cc.audioEngine.stop(audioID);\n    }\n\n    public BGMPlay(path:string,callback:(audioID:number)=>void=null)\n    {\n\n        //cc.error(path+\"#############背景音乐\");\n        if(this.playingBGM == path)\n            return;\n        this.playingBGM = path;\n        ccC.loadRes(path, cc.AudioClip, function (err, clip:cc.AudioClip) {\n\n            if (err) {\n                cc.error(\"err  \" + err.message || err);\n                return;\n            }\n            try{\n                var audioID = cc.audioEngine.playMusic(clip, true);\n                if(callback != null)\n                {\n                    callback(audioID);\n                }\n            }\n            catch(err)\n            {\n                cc.error(err);\n                cc.error(path+\"背景音乐有一点点错误也--------------------\");\n            }\n\n            \n        });\n    }\n    \n    public BGMStop()\n    {\n        cc.audioEngine.stopMusic();\n    }\n}\n"]}